asyncapi: "2.1.0"
info:
  title: bridge-machine-service-maintenance
  version: "1.0.0"
  description: |
    This service 

channels:
  public.data.service.tracking.consolidated:
    description: Maintenance intervention messages from kafka
    bindings:
      kafka:
        topic:
          partitions: 5
          cleanup.policy: delete
    publish:
      operationId: consumeMaintenanceIntervention
      traits:
        - $ref: "#/components/operationTraits/kafkaConsume"
      message:
        $ref: "#/components/messages/maintenanceInterventionPayload"
        
components:
  messages:
    maintenanceInterventionPayload:
      name: Maintenance intervention
      title: Maintenance intervention message
      summary: This is the definition of a maintenance intervention message
      traits:
        - $ref: "#/components/operationTraits/kafkaKey"
      schemaFormat: "application/vnd.apache.avro;version=1.9.0"
      contentType: avro
      payload:
        - $ref: "https://raw.githubusercontent.com/ept/avrodoc/master/schemata/example.avsc"
    
  operationTraits:
    kafkaConsume:
      bindings:
        kafka:
          groupId:
            type: string
            enum: ["bridge-machine-service-maintenance"]
    kafkaKey:
      bindings:
        kafka:
          key:
            type: string
            description: Equipment serial number

